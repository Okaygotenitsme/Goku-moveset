local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local p = Players.LocalPlayer

local tp = Instance.new("Tool")
tp.Name = "Teleport Kamehameha"
tp.RequiresHandle = false
tp.CanBeDropped = false
tp.Parent = p:WaitForChild("Backpack")

local function myHRP()
	local c = p.Character
	return c and c:FindFirstChild("HumanoidRootPart")
end

local function findTargets()
	local t = {}
	for _,pl in pairs(Players:GetPlayers()) do
		if pl ~= p and pl.Character then
			local r = pl.Character:FindFirstChild("HumanoidRootPart")
			if r then table.insert(t, r) end
		end
	end
	for _,d in pairs(workspace:GetDescendants()) do
		if d.Name == "Weakest Dummy" and d:FindFirstChild("HumanoidRootPart") then
			table.insert(t, d.HumanoidRootPart)
		end
	end
	return t
end

local function getValidTool()
	local bp = p:FindFirstChild("Backpack")
	if bp then
		for _,v in pairs(bp:GetChildren()) do
			if v:IsA("Tool") and (v.Name == "Normal Punch" or v.Name == "Kamehameha") then return v end
		end
	end
	local c = p.Character
	if c then
		for _,v in pairs(c:GetChildren()) do
			if v:IsA("Tool") and (v.Name == "Normal Punch" or v.Name == "Kamehameha") then return v end
		end
	end
	return nil
end

local function equipAndActivate(tool)
	if not tool then return end
	local hum = p.Character and p.Character:FindFirstChildOfClass("Humanoid")
	if not hum then return end
	if tool.Parent ~= p.Character then
		pcall(function() hum:EquipTool(tool) end)
		task.wait(0.06)
	end
	pcall(function() if typeof(tool.Activate) == "function" then tool:Activate() end end)
end

tp.Activated:Connect(function()
	local hrp = myHRP()
	if not hrp then return end
	local targets = findTargets()
	if #targets == 0 then return end
	local targetRoot = targets[math.random(#targets)]
	local saved = hrp.CFrame

	hrp.CFrame = targetRoot.CFrame * CFrame.new(0,0,6)

	local tool = getValidTool()
	if tool then equipAndActivate(tool) end

	local elapsed = 0
	local conn
	conn = RunService.Heartbeat:Connect(function(dt)
		elapsed = elapsed + dt
		local curHRP = myHRP()
		if not curHRP then conn:Disconnect() return end
		if targetRoot and targetRoot.Parent then
			curHRP.CFrame = targetRoot.CFrame * CFrame.new(0,0,6)
		end
		if elapsed >= 1.3 then
			conn:Disconnect()
			local backHRP = myHRP()
			if backHRP then backHRP.CFrame = saved end
		end
	end)
end)

local LocalPlr = game.Players.LocalPlayer
local hrp = LocalPlr.Character:WaitForChild("HumanoidRootPart", 10)

local t = Instance.new("Tool")
t.Name = "Instant Transmission"
t.RequiresHandle = false
t.ToolTip = "Instant Transmission"

t.Parent = LocalPlr.Backpack

t.Activated:Connect(function()
    local mousePos = LocalPlr:GetMouse().Hit.Position
    hrp.CFrame = CFrame.new(mousePos) * (hrp.CFrame - hrp.Position)
end)

local player = game.Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local function WaitPath(parent, path)
    local obj = parent
    for _, name in ipairs(path) do
        obj = obj:WaitForChild(name)
    end
    return obj
end

local iconLabel = WaitPath(playerGui, {
    "TopbarPlus","TopbarContainer","UnnamedIcon",
    "DropdownContainer","DropdownFrame","Bald",
    "IconButton","IconLabel"
})

local iconImage = WaitPath(playerGui, {
    "TopbarPlus","TopbarContainer","UnnamedIcon",
    "DropdownContainer","DropdownFrame","Bald",
    "IconButton","IconImage"
})

local filename = "GokuIcon.png"
local url = "https://raw.githubusercontent.com/Okaygotenitsme/Goku-moveset/main/Goku%20icon.png"

local function fileExists(path)
    return pcall(function() readfile(path) end)
end

local function UpdateIcon()
    if not fileExists(filename) then
        writefile(filename, game:HttpGet(url))
    end
    
    if iconLabel.Text ~= "Son Goku"
        or iconImage.Image ~= getcustomasset(filename)
    then
        iconLabel.Text = "Son Goku"
        iconImage.Image = getcustomasset(filename)
    end
end

UpdateIcon()

task.spawn(function()
    while true do
        task.wait(1)
        UpdateIcon()
    end
end)

local player = game:GetService("Players").LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()

local function removeCharacterMeshes()
    for _, item in ipairs(character:GetChildren()) do
        if item:IsA("CharacterMesh") then
            item:Destroy()
            print("Удален CharacterMesh: " .. item.Name)
        end
    end
end

removeCharacterMeshes()

--======================
--  SOUND LIBRARY (1 SOUND)
--======================

local SoundLib = {}

function SoundLib.GokuScream()
    local url = "https://raw.githubusercontent.com/Okaygotenitsme/Pokorenie-nebes-Hub/main/goku-roar.mp3"
    writefile("GokuScream.mp3", game:HttpGet(url))

    local s = Instance.new("Sound")
    s.SoundId = getcustomasset("GokuScream.mp3")
    s.Volume = 5
    s.Parent = LocalPlr.Character
    s:Play()
end

local SoundLib = {}

function SoundLib.GokuM1()
    local url = "https://github.com/Okaygotenitsme/Goku-moveset/raw/refs/heads/main/GokuM1.mp3"
    writefile("GokuM1.mp3", game:HttpGet(url))

    local s = Instance.new("Sound")
    s.SoundId = getcustomasset("GokuM1.mp3")
    s.Volume = 1
    s.Parent = game.Players.LocalPlayer.Character
    s:Play()
end

local SoundLib = {}

function SoundLib.GokuM2()
    local url = "https://github.com/Okaygotenitsme/Goku-moveset/raw/refs/heads/main/GokuM2.mp3"
    writefile("GokuM2.mp3", game:HttpGet(url))

    local s = Instance.new("Sound")
    s.SoundId = getcustomasset("GokuM2.mp3")
    s.Volume = 1
    s.Parent = game.Players.LocalPlayer.Character
    s:Play()
end

local SoundLib = {}

function SoundLib.GokuM3()
    local url = "https://github.com/Okaygotenitsme/Goku-moveset/raw/refs/heads/main/GokuM3.mp3"
    writefile("GokuM3.mp3", game:HttpGet(url))

    local s = Instance.new("Sound")
    s.SoundId = getcustomasset("GokuM3.mp3")
    s.Volume = 1
    s.Parent = game.Players.LocalPlayer.Character
    s:Play()
end

local SoundLib = {}

function SoundLib.GokuM4()
    local url = "https://github.com/Okaygotenitsme/Goku-moveset/raw/refs/heads/main/GokuM4.mp3"
    writefile("GokuM4.mp3", game:HttpGet(url))

    local s = Instance.new("Sound")
    s.SoundId = getcustomasset("GokuM4.mp3")
    s.Volume = 1
    s.Parent = game.Players.LocalPlayer.Character
    s:Play()
end

--======================
--  GOKU SCRIPT MADE BY: MELOTEN
--======================

local Players = game:GetService("Players")
local player = Players.LocalPlayer

local SHIRT_URL = "http://www.roblox.com/asset/?id=105796519104217"
local PANTS_URL = "http://www.roblox.com/asset/?id=96929785073176"

local function applyClothes(character)
    local shirt = character:FindFirstChildOfClass("Shirt") or Instance.new("Shirt")
    shirt.ShirtTemplate = SHIRT_URL
    shirt.Parent = character
    
    local pants = character:FindFirstChildOfClass("Pants") or Instance.new("Pants")
    pants.PantsTemplate = PANTS_URL
    pants.Parent = character
end

player.CharacterAdded:Connect(applyClothes)

if player.Character then
    applyClothes(player.Character)
end

local Players = game:GetService("Players")
local player = Players.LocalPlayer

--======================
--  ATTACK CONFIGURATION
--======================

local attacks = {
["1"] = { Name = "Kamehameha", OriginalId = "10468665991", AnimId = "113450724032380", StartTime = 6.4, Speed = 2.65, StopDelay = nil, Script = nil },
["2"] = { Name = "Meteor Combination", OriginalId = "10466974800", AnimId = "83905432418191", StartTime = 0.2, Speed = 1.8, StopDelay = nil, Script = nil },
["3"] = { Name = "Saiyan Beatdown", OriginalId = "10471336737", AnimId = "16944345619", StartTime = 0, Speed = 1, StopDelay = nil, Script = nil },
["4"] = { Name = "Saiyan Uppercut", OriginalId = "12510170988", AnimId = "18179181663", StartTime = 0, Speed = 1, StopDelay = nil, Script = nil }
}

--======================
--  ULTIMATE CONFIG
--======================

local ultimate = { Name = "Super Saiyan", OriginalId = "11343318134", AnimId = "12983333733", StartTime = 2, Speed = 0.5, Script = nil }

--======================
--  BAR & GLOW SETUP
--======================

local gui = player:WaitForChild("PlayerGui"):WaitForChild("Bar")
local health = gui.MagicHealth.Health

local parts = { health.Glow, health.Bar, health.Bar.Bar }
parts[1].Image = "rbxassetid://17136251821"
parts[2].Image = "rbxassetid://7884720727"
parts[3].Image = "rbxassetid://17136251960"

local color = Color3.fromRGB(255, 230, 80) -- ярко-жёлтый для Super Saiyan
for _, obj in ipairs(parts) do
    obj.ImageColor3 = color
end

--======================
--  WALL COMBO CONFIG
--======================

local wallCombo = { OriginalId = "15955393872", AnimId = "15943915877", StartTime = 0.05, Speed = 1, StopDelay = nil, 
  Script = function()
    local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local hrp = character:WaitForChild("HumanoidRootPart", 10)
    
local DISTANCE = 1_000_000

local function ActivateVoidRight()
    if not hrp or not hrp.Parent then return end
  
    local oldCFrame = hrp.CFrame
  
    task.wait(2.7)
  
    local rightOffset = hrp.CFrame.RightVector * DISTANCE
    local targetCFrame = CFrame.new(hrp.Position + rightOffset, hrp.Position + rightOffset + hrp.CFrame.LookVector)
  
    hrp.CFrame = targetCFrame
  
    task.wait(1)
  
    if oldCFrame and hrp and hrp.Parent then
        hrp.CFrame = oldCFrame
    end
end
    
ActivateVoidRight()
  end
}

--======================
--  ADDITIONAL MOVES CONFIG
--======================

local extraMoves = {
["FrontDash"] = { OriginalId = "10479335397", AnimId = "14046756619", StartTime = 0, Speed = 0.7, StopDelay = 1.2, Script = nil },
["MiniUppercut"] = { 
	OriginalId = "10503381238",
	AnimId = "",
	StartTime = 1.3,
	Speed = 1,
	StopDelay = nil,
	Script = function() 
		SoundLib.GokuM4()
	end
},
["Downslam"] = { 
	OriginalId = "10470104242",
	AnimId = "12684185971",
	StartTime = 0,
	Speed = 1,
	StopDelay = nil,
	Script = function()
	SoundLib.GokuM4()
	end
},
["M1_1"] = { 
	OriginalId = "10469493270",
	AnimId = "17889458563",
	StartTime = 0,
	Speed = 1,
	StopDelay = nil,
	Script = function()
		SoundLib.GokuM1() 
	end
},
["M1_2"] = { 
	OriginalId = "10469630950",
	AnimId = "17889461810",
	StartTime = 0,
	Speed = 1,
	StopDelay = nil,
	Script = function() 
		SoundLib.GokuM2()
	end
},
["M1_3"] = { 
	OriginalId = "10469639222",
	AnimId = "17889471098",
	StartTime = 0,
	Speed = 1,
	StopDelay = nil,
	Script = function()
		SoundLib.GokuM3()
	end
},
["M1_4"] = { 
	OriginalId = "10469643643",
	AnimId = "17889290569",
	StartTime = 0,
	Speed = 1,
	StopDelay = nil,
	Script = function()
	SoundLib.GokuM4()
	end
},
["SeriousPunch"] = { OriginalId = "12983333733", AnimId = "", StartTime = 0, Speed = 0.2, StopDelay = nil, Script = nil },

["UltAnim"] = {
    OriginalId = "12447707844",
    AnimId = "17292505729",
    StartTime = 0,
    Speed = 1,
    StopDelay = nil,
    Script = function()
        SoundLib.GokuScream()
        local player = game.Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
local humanoid = character:WaitForChild("Humanoid")
local runService = game:GetService("RunService")
        
local objectsToHide = {
    playerGui:WaitForChild("Hotbar"):WaitForChild("Backpack"),
    playerGui:WaitForChild("TouchGui"):WaitForChild("TouchControlFrame"),
    playerGui:WaitForChild("Bar"):WaitForChild("MagicHealth")
}

local function hideTemporarily(objects, duration)
    local previousStates = {}
    for i, obj in ipairs(objects) do
        previousStates[i] = obj.Visible
        obj.Visible = false
    end

    wait(duration)

    for i, obj in ipairs(objects) do
        obj.Visible = previousStates[i]
    end
end
        
local movementSpeed = 175

local runAnimation = Instance.new("Animation")
runAnimation.AnimationId = "rbxassetid://18897115785"
local animator = humanoid:FindFirstChildOfClass("Animator") or humanoid:WaitForChild("Animator")
local runTrack = animator:LoadAnimation(runAnimation)

local stopAnimation = Instance.new("Animation")
stopAnimation.AnimationId = "rbxassetid://17354976067"
local stopTrack = animator:LoadAnimation(stopAnimation)

local function moveForwardWithVelocity(duration, velocityFunc)
    local elapsed = 0
    while elapsed < duration do
        local deltaTime = runService.Heartbeat:Wait()
        elapsed = elapsed + deltaTime
        local vel = velocityFunc(elapsed)
        humanoidRootPart.Velocity = humanoidRootPart.CFrame.LookVector * vel + Vector3.new(0, humanoidRootPart.Velocity.Y, 0)
    end
end
        
spawn(function()
    wait(2)
    
    spawn(function()
        hideTemporarily(objectsToHide, 5.2)
    end)
    
    runTrack:Play()  
    moveForwardWithVelocity(4, function() return movementSpeed end)  

    runTrack:Stop()

    stopTrack:Play()
    stopTrack.TimePosition = 5.9
    stopTrack:AdjustSpeed(1)

    moveForwardWithVelocity(1, function(t) 
        return movementSpeed * (1 - t/1) 
    end)

    humanoidRootPart.Velocity = Vector3.new(0, humanoidRootPart.Velocity.Y, 0)
end)
    end
}
}

--======================
--  FUNCTIONS TO PLAY AND REPLACE ANIMATIONS
--======================

local function playAnim(humanoid, animId, startTime, speed, stopDelay, scriptCode)
    for _, track in pairs(humanoid:GetPlayingAnimationTracks()) do
        track:Stop()
    end

    local anim = Instance.new("Animation")  
    anim.AnimationId = "rbxassetid://" .. animId  

    local track = humanoid:LoadAnimation(anim)  
    track:Play()  
    track:AdjustSpeed(0)  
    track.TimePosition = startTime or 0  
    track:AdjustSpeed(speed or 1)  

    if scriptCode then
        pcall(scriptCode)
    end

    if stopDelay then  
        delay(stopDelay, function() track:Stop() end)  
    end
end

local function replaceAnimation(humanoid, data)
    if not data.AnimId or data.AnimId == "" then return end
    humanoid.AnimationPlayed:Connect(function(track)
        if track.Animation.AnimationId == "rbxassetid://"..data.OriginalId then
            playAnim(humanoid, data.AnimId, data.StartTime, data.Speed, data.StopDelay, data.Script)
        end
    end)
end

--======================
--  CHARACTER SETUP
--======================

local function setupCharacter(character)
    local humanoid = character:WaitForChild("Humanoid")

    for _, v in pairs(attacks) do replaceAnimation(humanoid, v) end  
    replaceAnimation(humanoid, ultimate)  
    replaceAnimation(humanoid, wallCombo)  
    for _, v in pairs(extraMoves) do replaceAnimation(humanoid, v) end
end

--======================
--  FIX ATTACK AND ULT NAMES
--======================

local player = game.Players.LocalPlayer

local function updateHotbar(attacks)
    local gui = player:WaitForChild("PlayerGui")
    local hotbar = gui:WaitForChild("Hotbar", 5)
    if not hotbar then return end
    local backpack = hotbar:FindFirstChild("Backpack")
    if not backpack then return end
    local hotbarFrame = backpack:FindFirstChild("Hotbar")
    if not hotbarFrame then return end

    for index, data in pairs(attacks) do  
        if data.Name and data.Name ~= "?" then  
            local baseButton = hotbarFrame:FindFirstChild(index)  
            if baseButton and baseButton:FindFirstChild("Base") and baseButton.Base:FindFirstChild("ToolName") then  
                baseButton.Base.ToolName.Text = data.Name  
            end  
        end  
    end
end

local function updateUltimateText(ultimate)
    if ultimate.Name == "?" then return end
    local gui = player:WaitForChild("PlayerGui")
    local bar = gui:WaitForChild("Bar", 5)
    if not bar then return end
    local magic = bar:FindFirstChild("MagicHealth")
    if not magic then return end
    local label = magic:FindFirstChild("TextLabel")
    if label then
        label.Text = ultimate.Name
    end
end

local function fixAttackNames(attacks, ultimate)
    for i = 1, 3 do
        delay(i, function()
            pcall(function()
                updateHotbar(attacks)
                updateUltimateText(ultimate)
            end)
        end)
    end
end

if player.Character then
    fixAttackNames(attacks, ultimate)
end
player.CharacterAdded:Connect(function(char)
    fixAttackNames(attacks, ultimate)
end)

--======================
--  SPAWN ANIMATION
--======================

local p = game.Players.LocalPlayer
local Humanoid = p.Character:WaitForChild("Humanoid")

for _, animTrack in pairs(Humanoid:GetPlayingAnimationTracks()) do
    animTrack:Stop()
end

local AnimAnim = Instance.new("Animation")
AnimAnim.AnimationId = "rbxassetid://14611879113"

local Animlol = Humanoid:LoadAnimation(AnimAnim)

Animlol:Play()
Animlol:AdjustSpeed(0)
Animlol.TimePosition = startTime
Animlol:AdjustSpeed(1)

--======================
--  INITIAL CHARACTER
--======================

if player.Character then setupCharacter(player.Character) end
player.CharacterAdded:Connect(setupCharacter)

--======================
--  AUTO-FIX ATTACK AND ULT NAMES
--======================

local function autoFixAttackNames()
    local player = game.Players.LocalPlayer
    local gui = player:WaitForChild("PlayerGui")
    
    task.spawn(function()
        while true do
            task.wait(1)  -- проверяем каждую секунду

            -- 1. Исправляем имена атак в хотбаре
            local hotbar = gui:FindFirstChild("Hotbar")
            if hotbar then
                local backpack = hotbar:FindFirstChild("Backpack")
                if backpack then
                    local hotbarFrame = backpack:FindFirstChild("Hotbar")
                    if hotbarFrame then
                        for index, data in pairs(attacks) do
                            if data.Name and data.Name ~= "?" then
                                local baseButton = hotbarFrame:FindFirstChild(index)
                                if baseButton and baseButton:FindFirstChild("Base") and baseButton.Base:FindFirstChild("ToolName") then
                                    if baseButton.Base.ToolName.Text ~= data.Name then
                                        baseButton.Base.ToolName.Text = data.Name
                                    end
                                end
                            end
                        end
                    end
                end
            end

            -- 2. Исправляем имя ульта
            if ultimate.Name ~= "?" then
                local bar = gui:FindFirstChild("Bar")
                if bar then
                    local magic = bar:FindFirstChild("MagicHealth")
                    if magic then
                        local label = magic:FindFirstChild("TextLabel")
                        if label and label.Text ~= ultimate.Name then
                            label.Text = ultimate.Name
                        end
                    end
                end
            end
        end
    end)
end

autoFixAttackNames()
